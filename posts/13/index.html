
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>PracticalWeb Ltd</title>
  <meta name="author" content="Sean Burlington">

  
  <meta name="description" content="I was originally excited about the embrace that Drupal seemed to have given to testing. However after spending some time with it I've concluded that &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.practicalweb.co.uk/posts/13">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="PracticalWeb Ltd" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-3381543-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">PracticalWeb Ltd</a></h1>
  
    <h2>Websites that work for you.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/09/30/drupal-is-not-test-friendly/">Drupal Is Not Test Friendly</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2009-09-30T00:00:00+01:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>30</span><span class='date-suffix'>th</span>, <span class='date-year'>2009</span></span> <span class='time'>12:00 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>
I was originally excited about the embrace that Drupal seemed to have given to testing.
</p>


<p>
However after spending some time with it I&#8217;ve concluded that Drupal really isn&#8217;t very test friendly.
</p>


<p>
Most tests for Drupal are integration tests not unit tests.
</p>


<p>
That is to say that they test a bunch of components together - not each bit separately.
</p>


<p>
This is because Drupal components (modules or functions) are not well encapsulated, global variables are used, data is cached within functions,  passed via the database etc.  
</p>


<p>
THis makes it much harder for the developer to create tests that validate functional increments, and means the suite of tests run very slowly.
</p>


<p>
A while ago I tried to run the tests for Drupal 7 - but gave up waiting after an hour. I was very surprised to find that both database and web server were being hit hard - when I was running on the command line!
</p>


<p>
Even the integration level testing isn&#8217;t all that great, it runs in an environment without JavaScript support - so the AJAX functionality can&#8217;t be tested. 
</p>


<p>
Testing is better than not testing - but having gotten into testing I&#8217;ve found Drupal&#8217;s environment frustrating. 
</p>


<p>
&nbsp;
</p>


<p>
&nbsp;
</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/09/04/drupal-has-no-api/">Drupal Has No API</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2009-09-04T00:00:00+01:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>4</span><span class='date-suffix'>th</span>, <span class='date-year'>2009</span></span> <span class='time'>12:00 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>
I&#8217;ve been using Drupal for a couple of years now, and know my way around it pretty well.
</p>


<p>
One of my biggest frustrations though is that it doesn&#8217;t really have an API.
</p>


<p>
Much of the functionality is only really available through the application, you can do things pretty easily by pointing and clicking, but try and automate part of this and you have to step through code, find form handlers, copy-paste parts of the functions and work out what parameters are required.
</p>


<p>
The example I found most recently was creating a translated version of a page.
</p>


<p>
My client is using a translation agency, we send them XML, they translate it and return the translated text in XML. 
</p>


<p>
So I start with an English page, send off an XML version, and when I get the XML translation back I need to add a new node related to the original.
</p>


<p>
But Drupal has no function &quot;translation_add()&quot; instead the functionality is embedded in &quot;translation_nodapi()&quot;.
</p>


<p>
If Drupal had an API there would be a well thought out set of functions to add, delete, and update translations of a node.
</p>


<p>
The name of Drupal&#8217;s documentation site http://api.drupal.org/ is misleading, this is just general documentation of Drupal functions, it isn&#8217;t an API. 
</p>


<p>
&nbsp;
</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/08/04/website-costs-fixed-price-and-bugs/">Website Costs, Fixed Price, and Bugs</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2009-08-04T00:00:00+01:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>4</span><span class='date-suffix'>th</span>, <span class='date-year'>2009</span></span> <span class='time'>12:00 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>
Three interesting posts I&#8217;ve read recently
</p>


<p>
http://www.contenthere.net/2009/08/fixed-bid-implementation-work-a-marriage-made-in-vegas.html
</p>


<p>
Large fixed bid projects are very hard to get right.
</p>


<p>
http://www.teamlalala.com/blog/2008/11/12/how-much-do-websites-cost/
</p>


<p>
How much do websites cost? Well it&#8217;s hard to say.
</p>


<p>
http://www.codinghorror.com/blog/archives/001239.html
</p>


<p>
You&#8217;re gonna have bugs - plan for it and log them so that you can analyse the most common ones and  target your budget effectively.  
</p>


<p>
Developing websites is a real challenge, and putting a business process around it so that all parties make a fair profit is hard too. 
</p>


<p>
But it&#8217;s an exciting business to be in and there are profits to be made. 
</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/07/24/multi-threaded-php/">Multi-threaded PHP</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2009-07-24T00:00:00+01:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>24</span><span class='date-suffix'>th</span>, <span class='date-year'>2009</span></span> <span class='time'>12:00 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>
OK so it isn&#8217;t quite multi-threaded, but forking and controlling processes in the command line environment is still pretty powerful and something I&#8217;ve wanted to do on a couple of occasions. 
</p>


<p>
http://brian.moonspot.net/php-fork
</p>


<p>
http://us.php.net/manual/en/book.pcntl.php
</p>



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/07/23/hope-is-not-a-risk-management-strategy/">Hope Is Not a Risk Management Strategy</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2009-07-23T00:00:00+01:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>23</span><span class='date-suffix'>rd</span>, <span class='date-year'>2009</span></span> <span class='time'>12:00 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>
This is a great post by Cory Foy
</p>


<p>
http://blog.cornetdesign.com/2009/06/hope-is-not-a-risk-management-strategy/
</p>


<p>
&nbsp;
</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/07/23/drupal-live-and-dev-sync/">Drupal Live and Dev Sync</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2009-07-23T00:00:00+01:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>23</span><span class='date-suffix'>rd</span>, <span class='date-year'>2009</span></span> <span class='time'>12:00 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>
When developing Drupal one often needs to pull recent copies of the live database into the dev environment.
</p>


<p>
Loading a dump into the dev database will update any existing tables, add any new ones - but it won&#8217;t remove tables from the dev environment that re not in live.
</p>


<p>
This causes problems with Drupal as module install and update hooks may need to create tables which don&#8217;t yet exist on live. 
</p>


<p>
My solution which assumes you have .my.cnf set up to provide login locally is below.
</p>


<p><code></p>

<h1>dump live db</h1>

<p>ssh live &ldquo;mysqldump livedb | gzip > /tmp/livedb.sql.gz&rdquo;</p>

<h1>download live db</h1>

<p>scp live:/tmp/livedb.sql.gz /tmp</p>

<h1>clean out dev db</h1>

<p>mysql -BNe &ldquo;show tables&rdquo; devdb | awk &lsquo;{print &ldquo;drop table &rdquo; $1 &ldquo;;&rdquo;} | mysql devdb</p>

<h1>copy live db to dev</h1>

<p>zcat /tmp/livedb.sql.gz | mysql devdb</p>

<h1>make sure test mails never go to real users!</h1>

<p>echo &ldquo;update users set mail=&lsquo;<a href="&#109;&#97;&#105;&#108;&#116;&#x6f;&#x3a;&#109;&#x65;&#x40;&#x65;&#120;&#x61;&#109;&#112;&#x6c;&#101;&#46;&#x63;&#x6f;&#109;">&#x6d;&#x65;&#64;&#x65;&#120;&#97;&#x6d;&#112;&#108;&#x65;&#46;&#99;&#x6f;&#x6d;</a>&rsquo;&rdquo; | mysql devdb
</code></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/07/22/installing-lame-on-debian/">Installing Lame on Debian</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2009-07-22T00:00:00+01:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>22</span><span class='date-suffix'>nd</span>, <span class='date-year'>2009</span></span> <span class='time'>12:00 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>
Debian has a very strict policy on free and legal software. This helps keep everyone honest, but sometimes a pragmatic approach is called for. MP3 is a file format that is patent encumbered - but also in universal use. 
</p>


<p>
I could use the supplied Ogg Vorbis tools but then my music wouldn&#8217;t work everywhere I want it to.
</p>


<p>
So I want to install Lame which is only available in source.
</p>


<p>
http://sourceforge.net/projects/lame/files/
</p>


<p>
Download and extract 
</p>


<p><code>
cd lame-398-2/</p>

<h1>install a build environment by pulling in the build dependencies for something useful (I chose php)</h1>

<p>sudo apt-get build-dep php5
sudo aptitude install fakeroot</p>

<h1>check build dependencies of lame</h1>

<p>cat debian/control</p>

<h1>and install them</h1>

<p>sudo aptitude install nasm libsndfile1-dev
chmod 700 debian/rules
dpkg-buildpackage -rfakeroot -uc -b
sudo dpkg -i ../lame_3.98.1_i386.deb ../libmp3lame0_3.98.1_i386.deb
</code></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/07/21/xdebug-and-eclipse/">Xdebug and Eclipse</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2009-07-21T00:00:00+01:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>21</span><span class='date-suffix'>st</span>, <span class='date-year'>2009</span></span> <span class='time'>12:00 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>
xdebug is an immensely powerful tool for exploring what your code really does.
</p>


<p>
You can get a long way using print_r  but ultimately this always requires that you predict the path your code will take - and the tricky bit about debugging is you need it when your predications have gone wrong.
</p>


<p>
It&#8217;s generally pretty easy to set up
</p>


<ul>
    <li> install the php5-xdebug package</li>
    <li>check that the Eclipse PHP preferences have xdebug as an option</li>
    <li>if you&#8217;re debugging locally the default settings should be OK</li>
    <li>create a site configuration in the debug dialog</li>
    <li>set a break point</li>
    <li>start debugging</li>
</ul>


<p>
If it doesn&#8217;t work at first restart Eclipse
</p>


<p>
Check that you have a browser configured in Eclipse
</p>


<p>
Not all settings seem to be picked up immediately  
</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/07/21/sql-greatest-and-least/">SQL Greatest and Least</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2009-07-21T00:00:00+01:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>21</span><span class='date-suffix'>st</span>, <span class='date-year'>2009</span></span> <span class='time'>12:00 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>
Most of the time I can get what I want out of SQL using the standard aggregate functions, but today I needed to find the latest timestamp from any one of three columns.
</p>


<p>
I achieved this using the GREATEST() function, it&#8217;s not party of the SQL standard but is commonly available.
</p>


<p>
GREATEST(<em>value</em> [<span class="OPTIONAL">, &#8230;</span>])<br />
</p>


<pre class="SYNOPSIS">
LEAST(<em>value</em> [<span class="OPTIONAL">, ...</span>])
</pre>


<p>
The GREATEST and LEAST
functions select the largest or smallest value from a list of any
number of expressions. 
</p>


<p><br /></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/07/21/configuring-wifi-with-debian/">Configuring WIFI With Debian</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2009-07-21T00:00:00+01:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>21</span><span class='date-suffix'>st</span>, <span class='date-year'>2009</span></span> <span class='time'>12:00 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>
I&#8217;ve just installed Debian Lenny and generally am impressed with how well things are auto detected and configured - so much easier than a few years ago - and in many ways easier than a Windows install where you have to constantly find 3rd party drivers to get things working.
</p>


<p>
 However getting wifi running was a bit trickier (largely because of FCC regulations  affecting licenses and default settings).
</p>


<p>
This document got me most of the way 
</p>


<p>
http://wiki.debian.org/iwlwifi
</p>


<p>
Additional lines in /etc/.network/interfaces
</p>


<p><code>
iface wlan0 inet dhcp
  pre-up ip link set wlan0 up
  wpa-driver wext
  wpa-conf /etc/wpa_supplicant/wpa_supplicant.conf</p>

<p></code></p>

<p>and wpa_supplicant.conf looks like
<code>
ctrl_interface=/var/run/wpa_supplicant</p>

<p>network={
     ssid=&ldquo;mynetwork&rdquo;
     psk=&ldquo;mypassword&rdquo;
}
</code></p>

<p>And it&#8217;s all working&#8230;</p>




<p>
This old bug seems to be fixed
</p>


<p>
 https://bugs.launchpad.net/ubuntu/+source/linux/+bug/288401
</p>

</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/14">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/posts/12">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/10/09/ubuntu-mysql-root-password-reset-init-file-not-found/">Ubuntu Mysql Root Password Reset (Init File Not Found)</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/04/27/add-annotations-to-grafana-via-elasticsearch/">Add Annotations to Grafana via Elasticsearch</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/03/18/git-stash-save-message/">Git Stash Save Message</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/03/13/puppet-vs-ansible/">Puppet vs Ansible</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/03/11/ssl-problems-in-jmeter-and-java-1-dot-7/">SSL Problems in Jmeter and Java 1.7</a>
      </li>
    
  </ul>
</section>


<section>
     <h1>Twitter</h1>
            <a class="twitter-timeline"  href="https://twitter.com/seanburlington" data-widget-id="524302229054832640">Tweets by @seanburlington</a>
            <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
          
          
 </section>




<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/101485141680594541671?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>


<script>
  (function() {
    var cx = '006368662332329297011:kk0vbscc1zc';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

  
</aside>

    </div>
  </div>
  <footer role="contentinfo">
<p>&copy; copyright 2016 - PracticalWeb Ltd all rights reserved</p>

<p>UK registered company number 06427950</p>

</footer>
  



<script type="text/javascript">
// sean 3

      var disqus_shortname = 'practicalweb';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
