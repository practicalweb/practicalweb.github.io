
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>PracticalWeb Ltd</title>
  <meta name="author" content="Sean Burlington">

  
  <meta name="description" content="This has been annoying to work out. The puppet apache module will by default create the document root for a virtualhost if it is not already defined &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.practicalweb.co.uk/posts/4">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="PracticalWeb Ltd" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-3381543-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">PracticalWeb Ltd</a></h1>
  
    <h2>Websites that work for you.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:www.practicalweb.co.uk" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/03/11/puppet-apache-virtualhost-docroot-provided-by-rpm/">Puppet - Apache Virtualhost Docroot Provided by Rpm</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-03-11T00:00:00+00:00'><span class='date'><span class='date-month'>Mar</span> <span class='date-day'>11</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>12:00 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This has been annoying to work out.</p>




<p>The <a href="https://forge.puppetlabs.com/puppetlabs/apache">puppet apache module</a> will by default create the document root for a virtualhost if it is not already defined. But since I wanted the documentroot to be managed by a custom   RPM I don&#8217;t have a reference to the actual directory in puppet.</p>




<p>It seems the thing to do is to create file named after the document root - but with an alternate path property. This way puppet/apache knows not to create the documentroot, and the one I make in puppet doesn&#8217;t then get in the way of the RPM one.</p>


<p><code></p>

<p>  apache::vhost { &lsquo;www.vagrant&rsquo;:
    priority        => &lsquo;10&rsquo;,
    port            => &lsquo;80&rsquo;,
    docroot         => &ldquo;/var/www/html/foo&rdquo;,
    docroot_owner   => &lsquo;root&rsquo;,
    docroot_group   => &lsquo;root&rsquo;,
    override        => &lsquo;All&rsquo;,
    require         => Package[&lsquo;foo&rsquo;],
  }</p>

<p>  file {&lsquo;/var/www/html/foo&rsquo;:
      path => &ldquo;/usr/share/doc/foo&rdquo;,
      content => &ldquo;Puppet needs a file with an object name of teh docroot defined, this is that dummy file, the real docroot is defined in an rpm\n &rdquo;,
      owner => root,
  }</p>

<p></code></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/03/11/eclipse-hangs/">Eclipse Hangs</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-03-11T00:00:00+00:00'><span class='date'><span class='date-month'>Mar</span> <span class='date-day'>11</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>12:00 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This worked for me today - saving it here so I can find it again</p>




<p><a href="http://off-topic.biz/en/eclipse-hangs-at-startup-showing-only-the-splash-screen/">http://off-topic.biz/en/eclipse-hangs-at-startup-showing-only-the-splash-screen/</a></p>




<pre>
cd .metadata/.plugins
mv org.eclipse.core.resources org.eclipse.core.resources.bak
Start eclipse. (It should show an error message or an empty workspace because no project is found.)
Close all open editors tabs.
Exit eclipse.
rm -rf org.eclipse.core.resources (Delete the newly created directory.)
mv org.eclipse.core.resources.bak/ org.eclipse.core.resources (Restore the original directory.)
Start eclipse and start working. :-)
</pre>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/02/12/reinstall-grub-after-windows-breaks-it/">Reinstall Grub After Windows Breaks It</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-02-12T00:00:00+00:00'><span class='date'><span class='date-month'>Feb</span> <span class='date-day'>12</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>12:00 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>One of those things that happens from time to time on a dual boot system&#8230;</p>




<p>Windows breaks grub, usually if I&#8217;ve reinstalled windows, this can lead to a unbootable system.</p>




<p>Boot from a Ubuntu (or other distro) live disk or USB stick.</p>




<p>Figure out which your disks and partitions are.</p>


<p><code></p>

<pre><code>sudo mount /dev/sdXY /mnt
</code></pre>

<h1>if there is a boot partition</h1>

<pre><code>sudo mount /dev/sdUV /mnt/boot
sudo grub-install --recheck --root-directory=/mnt /dev/sdZ 
</code></pre>

<p></code></p>

<p>When you reboot grub should be back to normal.</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/02/05/mini-scripts-to-obtain-git-id-branch-tag/">Mini Scripts to Obtain Git Id/branch/tag</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-02-05T00:00:00+00:00'><span class='date'><span class='date-month'>Feb</span> <span class='date-day'>5</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>12:00 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><code>
$new_branch=$1 # passed as param</p>

<p>current_branch=&ldquo;$(git symbolic-ref HEAD 2>/dev/null)&rdquo;
current_branch=${current_branch##refs/heads/}</p>

<p>current_id=$(git rev-parse &ndash;short origin/$current_branch)</p>

<p>new_id=$(git rev-parse &ndash;short origin/$new_branch)</p>

<p>last_tag=$(git describe &ndash;abbrev=0 &ndash;tags)</p>

<p></code></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/11/26/git-submodules-and-subtrees/">Git Submodules and Subtrees</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-11-26T00:00:00+00:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>26</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>12:00 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Git has the concept of both submodules and subtrees, there seem to be some problems with each solution, nether being well loved as far as I can see.</p>




<p>Both add significant complexity to a project, and require extra care - but the alternative is monolithic projects or a lot of copy-pasting.</p>




<p>Submodules allow another git repo to be nested inside the main one, you can then commit to either repo from the same filesystem.<br />
The &#8220;parent&#8221; repo references a specific tag/branch of the child one - it&#8217;s just this reference which is committed (and can be updated) in the parent.<br />
Commits in the parent relating to changes in subtree just show the ID changing and any message made when committing an updated version of the module. You can see commit history for the submodule when you are in that directory.
</p>


<p>The downside here being that neither a regular checkout nor a github tarball includes the child repo which adds overhead to dev build and server deploys.</p>




<p>Subtrees allow an additional external reference to be added and checked out as a subdirectory, this time the whole subdirectory is committed to the parent - but not the reference.<br />
The local repo does hold a reference and this allows the child repo to be merged in (preserving any local patches).<br />
The downside here is that the external reference has to be added manually to any repo that needs it, you don&#8217;t see the submodule history in the parent.</p>




<p>There&#8217;s a good article here <a href="http://codingkilledthecat.wordpress.com/2012/04/28/why-your-company-shouldnt-use-git-submodules/">http://codingkilledthecat.wordpress.com/2012/04/28/why-your-company-shouldnt-use-git-submodules</a> which basically says to use another tool - but that has it&#8217;s own set of problems.</p>



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/11/24/vagrant-puppet-project-to-setup-a-rpm-build-server-and-custom-yum-repository/">Vagrant / Puppet Project to Setup a RPM Build Server and Custom Yum Repository</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-11-24T00:00:00+00:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>24</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>12:00 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&#8217;ve published a project on github <a href="https://github.com/practicalweb/vagrant-rpmbuild">https://github.com/practicalweb/vagrant-rpmbuild</a></p>




<p>The project contains a Vagrant config file, and Puppet manifests that together with an appropriate basebox will create a VM setup to build RPMS and host them on a Custom Yum repository</p>




<p>To run this</p>




<ol>
<li><p>Install vagrant <a href="http://vagrantup.com/">http://vagrantup.com/</a> (on Ubuntu just <code>apt-get install vagrant</code>)</p></li>
<li><p>Install Virtualbox <a href="https://www.virtualbox.org/wiki/Downloads">https://www.virtualbox.org/wiki/Downloads</a> (again on Ubuntu <code>apt-get install virtualbox</code>)</p></li>
<li><p>Clone this reporitory <code>git clone git@github.com:practicalweb/vagrant-rpmbuild.git</code></p></li>
<li><p>run <code>vagrant up</code> from the root of your cloned repository (NB the first time you do the a 600Mb base image will be downloaded)</p></li>
<li><p>run <code>vagrant ssh</code> to connect to the new VM  </p></li>
<li><p>To build the demo rpm and publish it locally run <code>/vagrant/build-rpm.sh</code> the key password is &#8216;secret&#8217;</p></li>
<li><p>To install the demo package on the VM run <code>sudo yum install demo</code></p></li>
</ol>


<p>There is a Vagrant port forwarding rule, and firewall setup to allow the yum repo to be accessed on the host machine as http://localhos:8088/repo</p>




<p>This project is intended as documentation of how to setup this build environment, and as a starting point for further customisation, I&#8217;m sure it isn&#8217;t perfect, I hope it is useful.</p>




<p>It&#8217;s all released under GPL with no promise that it is fot for any purpose - see LICENCE.txt </p>




<p>I&#8217;ve tried to group the code logically, there are 4 modules</p>




<dl>
<dt>base</dt>
    <dd>This contains some generic stuff, pulling in a couple of packages not in the minimal centos install but that I find essential.</dd><dd>
    </dd><dd>The idea is that I would use this base module on every server I setup.</dd>

  

<dt>rpmbuild</dt>
    <dd>Just what is needed to actually build the RPMs</dd><dd>
  
  </dd>

<dt>tomyumrepo</dt>
     <dd>Just what is needed to serve a custom yum repository, the packages could be built elsewhere</dd>
  <dt>usemyrepo</dt>
     <dd>Config to setup a machine to consume yum packages.</dd>
     <dd>This could be added to the setup for any machine that needs to use the custom packages</dd>
</dl>


<p>I&#8217;ve included a minimal RPM project to get things rolling, it just installs a single text file.</p>




<p>I&#8217;ve built a GPG key to sign packages with, and also included a script ( generate-gpg-key.sh ) which shows how to generate a new one, edit this file to make your own key.</p>




<p>The base box I&#8217;ve defined is a minimal install of CentOS 6.3 (64 bit) with the dependencies required for vagrant.</p>




<p>Base boxes are quite a heavy download, but you only need to do it once and then you can have as many VMs as you want based on them, because the base is minimal and all extra config is done in puppet each of these VMs can serve a very differnt purpose - just by changing the Vagrantfile and puppet config.</p>




<p>The Vagrantfile runs puppet in standalone mode, but the modules <em>should</em> work with a client/server Puppet setup - so hopefully migrating the Vagrant setup to any Puppet manged system should be easy.</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/11/22/varnish-on-two-ports-with-separate-backends/">Varnish on Two Ports, With Separate Backends</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-11-22T00:00:00+00:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>22</span><span class='date-suffix'>nd</span>, <span class='date-year'>2012</span></span> <span class='time'>12:00 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>We have a site with a hardware ssl accelerator wich routes http traffic to port 80 and decrypted https traffic (so back to http) to port 443. We wanted varnish to cache the 443 traffic, and I came up with this proof of concept config, in reality you&#8217;d want to have a bunhch of different rules for your https site to ensure you cache only what you want to. </p>




<p>in /etc/varnish/default.vcl</p>


<p><code>
backend default {
    .host = &ldquo;www.example.com&rdquo;;
    .port = &ldquo;80&rdquo;;
}</p>

<p>backend secure {
        .host = &ldquo;www.example.com&rdquo;;
        .port = &ldquo;443&rdquo;;
}</p>

<p>sub vcl_recv {</p>

<p>set req.http.Host = &ldquo;www.example.com&rdquo;;</p>

<p>if (server.port == 7081) {
                set req.http.host = &ldquo;www.example.com&rdquo;;
                set req.http.port = 443;
                set req.backend = secure;
                return(lookup);
}
</code></p>

<p>and in /etc/default/varnish</p>


<p><code>
DAEMON_OPTS=&ldquo;-a :6081,:7081 \
             -T localhost:6082 \
             -f /etc/varnish/default.vcl \
             -S /etc/varnish/secret \
             -s malloc,256m&rdquo;</p>

<p></code></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/11/21/how-to-create-a-custom-yum-repository-on-centos-6/">How to Create a Custom Yum Repository on Centos 6</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-11-21T00:00:00+00:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>21</span><span class='date-suffix'>st</span>, <span class='date-year'>2012</span></span> <span class='time'>12:00 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>If you want to create custom rpms and install then with the usual automated dependency management you&rsquo;ll need your own yum repository. This is just the RPMS and metadata in the format of static xml files served by a webserver.</p>

<h2>First you need a GPG key to sign your packages.</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c"># make some randomness if running headless </span>
</span><span class='line'>sudo rngd -r /dev/urandom
</span><span class='line'><span class="c"># start the agent</span>
</span><span class='line'>gpg-agent --use-standard-socket --daemon
</span><span class='line'><span class="c"># interactive key generation (accept the defaults for key type, provide your name and email when promted)</span>
</span><span class='line'>gpg --gen-key
</span><span class='line'><span class="c"># </span>
</span><span class='line'>gpg --export -a <span class="s1">&#39;My Name&#39;</span> &gt; MY-RPM-GPG-KEY
</span></code></pre></td></tr></table></div></figure>


<p>You won&rsquo;t need the random generator if you do this on a desktop, but on a headless system I found I needed this. These actions will store a private key in your keyring, and a public key in the specified file.</p>

<h2>Build your rpm</h2>

<p>First configure rpm to use the key you just added to your key ring, checing you don&rsquo;t oveerwrite earlier configuration).</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="o">[</span> ! -f ~/.rpmmacros <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s1">&#39;%_signature gpg</span>
</span><span class='line'><span class="s1">%_gpg_name  My Name</span>
</span><span class='line'><span class="s1">&#39;</span> &gt; ~/.rpmmacros
</span></code></pre></td></tr></table></div></figure>


<p>Now build your RPM (assuming you are already setup to do this).</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>rpmbuild -bb --sign ~/rpmbuild/SPECS/my-project.spec
</span></code></pre></td></tr></table></div></figure>


<h2>Setup the Yum Repo</h2>

<p>Setup apache, make the directory structure, with teh repo files. This can be the same or a different server to your build machine.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c"># make the repo base url</span>
</span><span class='line'>sudo mkdir -p /var/www/html/myrepo
</span><span class='line'><span class="c"># make it wrietable by you normal account</span>
</span><span class='line'>sudo chown <span class="k">$(</span>id -un<span class="k">)</span>.<span class="k">$(</span>id -gn<span class="k">)</span> /var/www/html/myrepo
</span><span class='line'><span class="c"># copy you rpm files</span>
</span><span class='line'>cp *rpm /var/www/html/myrepo
</span><span class='line'><span class="c"># create the metadata</span>
</span><span class='line'>createrepo /var/www/html/myrepo
</span><span class='line'>
</span><span class='line'><span class="c"># Setup an apache Alias for this directory</span>
</span><span class='line'><span class="nb">echo</span> <span class="s1">&#39;Alias /myrepo/ /var/www/html/myrepo/</span>
</span><span class='line'><span class="s1">&#39;</span> &gt; /etc/httpd/conf.d/my-yum-repo
</span><span class='line'>
</span><span class='line'><span class="c"># restart Apache to pickup the change</span>
</span><span class='line'>service restart httpd
</span></code></pre></td></tr></table></div></figure>


<h2>Configure the system that will use the custom repo</h2>

<p>Copy over the GPG key, and import it into the  rpm database.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo rpm --import MY-RPM-GPG-KEY
</span></code></pre></td></tr></table></div></figure>


<p>Configure yum to use the new repo.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">echo</span> <span class="err">&#39;</span><span class="o">[</span>my-repo<span class="o">]</span>
</span><span class='line'><span class="nv">name</span><span class="o">=</span>My Custom Packages
</span><span class='line'><span class="nv">baseurl</span><span class="o">=</span>http://yum.example.com/myrepo
</span><span class='line'>&gt; /etc/yum.repos.d/my.repo
</span></code></pre></td></tr></table></div></figure>


<p>Now you should be able to install your custom packages with regular yum commands. When you update your rpms just re-run the createrepo command to update the metadata.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/11/20/satellite-vs-puppet/">Satellite vs Puppet</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-11-20T00:00:00+00:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>20</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>12:00 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&#8217;ve been using Puppet for a little while and am now working on a project that will be using RedHat&#8217;s Satellite (the upstream project is Spacewalk).</p>




<p>I haven&#8217;t really used puppet in anger on production systems yet, I&#8217;m referring to the open source edition of Puppet, and have only read about Satellite, but I didn&#8217;t find much comparison out there so thought it worth writing up what I&#8217;ve found.</p>




<p><p>They key differences that strike me are<p></p>

<p><ul>
<li>Satellite is RedHat/Centos only, Puppet works on multiple distributions, and even on Windows to some extent</li>
<li>Satellite is primarily a GUI driven system whereas Puppet is primarily text configuration (puppet has a web dashboard but it&rsquo;s really just a log viewer)</li></p>

<p><li>Satellite can manage provisioning of new systems (I&rsquo;m using openstack for provisioning new VMs anyway, Razor is said to work well with Puppet for provisioning)</li></p>

<p><li>Satellite manages configuration via simple templates with limited variable use, Puppets templates are fully scriptable</li></p>

<p><li>Puppet has a very rich dependency system (eg you can trigger an Apache restart whenever a configuration change occurs</li></p>

<p><li>Satellite uses a mixture of technologies (python, Java, C) puppet is written in Ruby.</li></p>

<p><li>Puppet is available as a package on Ubuntu/debian systems, on Redhat/centos it has to be installed via the EPEL repo, pulling in extra dependencies</li></p>

<p></ul></p>

<p><p>Personally I much prefer puppet&rsquo;s approach, it&rsquo;s easy to keep all the config in git and test changes in a dev env before rolling out.</p></p>

<p><p>I love puppets declarative approach, and the ability to chain dependencies</p></p>

<p><p>That said I&rsquo;m really looking forward to playing with Satellite, finding out how provisioning works when all the servers are VMs and seeing how we manage the dependency tracking</p></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/11/12/changing-default-port-of-memcache-on-centos-6/">Changing Default Port of Memcache on Centos 6</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2012-11-12T00:00:00+00:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>12</span><span class='date-suffix'>th</span>, <span class='date-year'>2012</span></span> <span class='time'>12:00 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>One of those things that just took me a lot longer than I expected&#8230;</p>




<p>Changing memcache port sdeems simple enough - just edit 
/etc/sysconfig/memcached and change the PORT value</p>




<p>BUT on a new centOS install memecache failed to start on any non-standard port.</p>


<p>To see any error message I had to edit the file /etc/init.d/memcached</p></p>

<p>and change the start line to </p>


<p><code></p>

<p>daemon &ndash;pidfile ${pidfile} memcached -d -v -p $PORT -u $USER  -m $CACHESIZE -c $MAXCONN -P ${pidfile} $OPTIONS
</code></p>

<p>Just adding the -v makes output verbose and I could see an error like </p>


<p><code>
memcache failed to listen on TCP port 11311 : Permission denied
</code></p>

<p>At this point I realised selinux was enabled by default, I tend to forget about this as it is so common for it to be disabled.</p>




<p><p>In order to add a new allowed port I added the following packages to edit selinux rules<p></p>

<p><code>policycoreutils-python
setroubleshoot-server</code></p>

<p><p>To check the name of the memcache port</p>
<code>
semanage port -l | grep memcache
</code>
<p>Then to allow the new port</p>
<code>
sudo semanage port -a -t memcache_port_t -p tcp 11311
</code></p>

<p><p>And now memcache works on the port I need for this project.</p></p>

<p><p>Sadly I don&rsquo;t see any good puppet modules to help with this, and it still seems selinux is very commonly disabled as it is tricky to work with.</p></p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/5">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/posts/3">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/02/17/ubuntu-disk-encryption-password/">Ubuntu Disk Encryption Password</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/02/16/git-integration-branch-based-workflow/">Git Integration Branch Based Workflow</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/01/16/elk-gotchas/">ELK Gotchas</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/12/03/non-root-packet-capture-in-wireshark/">Non-root Packet Capture in Wireshark</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/12/03/specifying-mtu-for-a-vpn-connection-in-networkmanager/">Specifying MTU for a VPN Connection in NetworkManager</a>
      </li>
    
  </ul>
</section>


<section>
     <h1>Twitter</h1>
            <a class="twitter-timeline"  href="https://twitter.com/seanburlington" data-widget-id="524302229054832640">Tweets by @seanburlington</a>
            <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
          
          
 </section>




<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/101485141680594541671?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>

    </div>
  </div>
  <footer role="contentinfo">
<p>&copy; copyright 2015 - PracticalWeb Ltd all rights reserved</p>

<p>UK registered company number 06427950</p>

</footer>
  



<script type="text/javascript">
// sean 3

      var disqus_shortname = 'practicalweb';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
